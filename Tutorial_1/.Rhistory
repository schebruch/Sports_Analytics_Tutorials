salaries
salaries <- salaries %>% select(year = yearID, team = teamID, league = lgID, playerID, salary)
avg_salaries%>% ggplot(aes(year, avg_salary, color = league)) + geom_point() + xlab("Year") + ylab("Average_Salary") + ggtitle("Average MLB Salary since 1985") +
scale_y_continuous(labels = comma) + theme_bw()
salaries %>% group_by(year) %>% mutate(zSalary = zscore(salary)) %>% ungroup()
install.packages("R.basic")
salaries %>% group_by(year) %>% mutate(avg_salary = mean(salary), varSalary = sd(salary)) %>% ungroup() %>% mutate(ZSalary = salary - avg_salary /sd(salary))
salaries %>% group_by(year) %>% mutate(avg_salary = mean(salary), varSalary = sd(salary)) %>% ungroup() %>% mutate(ZSalary = (salary - avg_salary )/sd(salary))
summary(recent_salaries, group = year)
summary(recent_salaries)
salaries %>% group_by(year) %>% mutate(avg_salary = mean(salary), varSalary = sd(salary)) %>% ungroup() %>% mutate(ZSalary = (salary - avg_salary )/sd(salary))
head(batting)
batting <- batting %>% filter( year >= 1985) %>% select(playerID, year = yearID, team = teamID, G, AB, R, H, X2B, X3B, HR, RBI, SB, CS, BB, SO)
batting <- batting %>% filter(yearID >= 1985) %>% select(playerID, year = yearID, team = teamID, G, AB, R, H, X2B, X3B, HR, RBI, SB, CS, BB, SO)
head(batting)
batting <- batting %>% filter(yearID >= 1985) %>% select(playerID, year = yearID, team = teamID, G, AB, R, H, X2B, X3B, HR, RBI, SB, CS, BB, SO)
batting <- batting %>% filter(yearID >= 1985) %>% select(playerID, year = yearID, team = teamID, G, AB, R, H, X2B, X3B, HR, RBI, SB, CS, BB, SO, HBP)
batting <- read.csv(paste0(path, "Batting.csv"))
batting <- batting %>% filter(yearID >= 1985) %>% select(playerID, year = yearID, team = teamID, G, AB, R, H, X2B, X3B, HR, RBI, SB, CS, BB, SO, HBP)
batting <- read.csv(paste0(path, "Batting.csv"))
batting <- batting %>% filter(yearID >= 1985) %>% select(playerID, year = yearID, team = teamID, G, AB, R, H, X2B, X3B, HR, RBI, SB, CS, BB, SO, IBB, HBP, SH, SF, GIDP)
batting <- batting %>% mutate(BA = H/AB, OBP = (H + BB + HBP)/AB + BB + HBP + SF, SLG = (H + X2B + 2*X3B + 3*HR)/AB, OPS = OBP + SLG)
head(batting)
batting <- read.csv(paste0(path, "Batting.csv"))
batting <- batting %>% filter(yearID >= 1985, AB > 100) %>% select(playerID, year = yearID, team = teamID, G, AB, R, H, X2B, X3B, HR, RBI, SB, CS, BB, SO, IBB, HBP, SH, SF, GIDP) %>% mutate(BA = H/AB, OBP = (H + BB + HBP)/AB + BB + HBP + SF, SLG = (H + X2B + 2*X3B + 3*HR)/AB, OPS = OBP + SLG)
head(batting)
batting <- read.csv(paste0(path, "Batting.csv"))
batting <- batting %>% filter(yearID >= 1985, AB > 100) %>% group_by(playerID, year) %>% summarise(playerID, year = yearID, team = teamID, G, AB, R, H, X2B, X3B, HR, RBI, SB, CS, BB, SO, IBB, HBP, SH, SF, GIDP) %>% mutate(BA = H/AB, OBP = (H + BB + HBP)/AB + BB + HBP + SF, SLG = (H + X2B + 2*X3B + 3*HR)/AB, OPS = OBP + SLG)
batting <- batting %>% filter(yearID >= 1985, AB > 100) %>% group_by(playerID, year = yearID) %>% summarise( G = sum(G), AB = sum(AB),R = sum(R), H = sum(H), X2B = sum(X2B), X3B = sum(X3B), HR = sum(HR), RBI = sum(RBI), SB = sum(SB), CS = sum(CS), BB = sum(BB), SO = sum(SO), IBB = sum(IBB), HBP = sum(HBP), SH = sum(SH), SF = sum(SF), GIDP = sum(GIDP)) %>% mutate(BA = H/AB, OBP = (H + BB + HBP)/AB + BB + HBP + SF, SLG = (H + X2B + 2*X3B + 3*HR)/AB, OPS = OBP + SLG)
head(batting)
batting <- batting %>% inner_join(player_info, by = "playerID")
player_info <- player_info %>% separate(debut, "debut_year", sep="-") %>%
select(playerID, birthYear, nameFirst,  nameLast, debut_year)
batting <- inner_join(batting, player_info, by = "playerID")
player_info
batting
players <- players %>% separate(debut, "debut_year", sep="-") %>%
select(playerID, birthYear, nameFirst,  nameLast, debut_year)
players <- players %>% separate(debut, "debut_year", sep="-") %>%
select(playerID, birthYear, nameFirst,  nameLast, debut_year)
batting <- inner_join(batting, players, by = "playerID")
head(batting)
batting <- batting %>% mutate(year_id = paste(player_id, year, sep="_"))
batting <- batting %>% mutate(year_id = paste(playerID, year, sep="_"))
head(batting)
salaries <- salaries %>% mutate(year_id = paste(player_id = playerID, year = yearID, sep="_")) %>% select(year_id, salary)
salaries <- salaries %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year, salary)
salaries <- salaries %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year_id, salary)
salaries <- read.csv(paste0(path, "Salaries.csv"))
salaries <- salaries %>% select(year = yearID, team = teamID, league = lgID, playerID, salary)
salaries <- salaries %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year_id, salary)
salaries
batting <- inner_join(batting, salaries, by = "year_id")
head(batting)
path <- "../Data/baseballdatabank-2019.2/core/"
salaries <- read.csv(paste0(path, "Salaries.csv"))
players <- read.csv(paste0(path, "People.csv"))
batting <- read.csv(paste0(path, "Batting.csv"))
head(players)
salaries <- salaries %>% select(year = yearID, team = teamID, league = lgID, playerID, salary)
avg_salaries <- salaries %>% group_by(year, league) %>% mutate(avg_salary = mean(salary)) %>% ungroup()
avg_salaries
salaries <- salaries %>% select(year = yearID, team = teamID, league = lgID, playerID, salary)
path <- "../Data/baseballdatabank-2019.2/core/"
salaries <- read.csv(paste0(path, "Salaries.csv"))
players <- read.csv(paste0(path, "People.csv"))
batting <- read.csv(paste0(path, "Batting.csv"))
head(players)
salaries <- salaries %>% select(year = yearID, team = teamID, league = lgID, playerID, salary)
avg_salaries <- salaries %>% group_by(year, league) %>% mutate(avg_salary_league_year = mean(salary)) %>% ungroup() %>% group_by(year) %>% mutate(avg_salary_year = mean(salary)) %>% ungroup()
avg_salaries
avg_salaries_by_league <- salaries %>% group_by(year, league) %>% summarise(avg_salary_league_year = mean(salary)) %>% ungroup()
avg_salaries_by_year <- salaries %>% group_by(year) %>% summarise(avg_salary_league = mean(salary)) %>% ungroup()
avg_salaries_by_league
avg_salaries_by_year
ggplot() + geom_point(data = avg_salaries_by_league, aes(x = year, y = avg_salary_league_year))
ggplot() + geom_point(data = avg_salaries_by_league, aes(x = year, y = avg_salary_league_year), color = "black") +
geom_point(data = avg_salaries_by_year, aes(x = year, y = avg_salary_league), color = league) + xlab("Year") + ylab("Average_Salary") + ggtitle("Average MLB Salary since 1985") +  scale_y_continuous(labels = comma) + theme_bw()
avg_salaries_by_year
ggplot() + geom_point(data = avg_salaries_by_league, aes(x = year, y = avg_salary_league_year, color = league)) +
geom_point(data = avg_salaries_by_year, aes(x = year, y = avg_salary_league)) + xlab("Year") + ylab("Average_Salary") + ggtitle("Average MLB Salary since 1985") +  scale_y_continuous(labels = comma) + theme_bw()
ggplot() + geom_line(data = avg_salaries_by_league, aes(x = year, y = avg_salary_league_year, color = league)) +
geom_line(data = avg_salaries_by_year, aes(x = year, y = avg_salary_league)) + xlab("Year") + ylab("Average_Salary") + ggtitle("Average MLB Salary since 1985") +  scale_y_continuous(labels = comma) + theme_bw()
ggplot() + geom_line(data = avg_salaries_by_league, aes(x = year, y = avg_salary_league_year, color = league)) +
geom_line(data = avg_salaries_by_year, aes(x = year, y = avg_salary_league, color = "black")) + xlab("Year") + ylab("Average_Salary") + ggtitle("Average MLB Salary since 1985") +  scale_y_continuous(labels = comma) + theme_bw()
ggplot() + geom_line(data = avg_salaries_by_league, aes(x = year, y = avg_salary_league_year, color = league)) +
geom_line(data = avg_salaries_by_year, aes(x = year, y = avg_salary_league, color = "MLB")) + xlab("Year") + ylab("Average_Salary") + ggtitle("Average MLB Salary since 1985") +  scale_y_continuous(labels = comma) + theme_bw()
recent_salaries <- salaries %>% filter(year >= 2012)
recent_salaries %>% ggplot(aes(group = year, x = year, y = salary)) + geom_boxplot() + theme_bw() + scale_y_continuous(labels = comma)
#in case the player had multiple stints
batting <- batting %>% filter(yearID >= 1985, AB > 100) %>% group_by(playerID, year = yearID) %>% summarise( G = sum(G), AB = sum(AB),R = sum(R), H = sum(H), X2B = sum(X2B), X3B = sum(X3B), HR = sum(HR), RBI = sum(RBI), SB = sum(SB), CS = sum(CS), BB = sum(BB), SO = sum(SO), IBB = sum(IBB), HBP = sum(HBP), SH = sum(SH), SF = sum(SF), GIDP = sum(GIDP)) %>% mutate(BA = H/AB, OBP = (H + BB + HBP)/AB + BB + HBP + SF, SLG = (H + X2B + 2*X3B + 3*HR)/AB, OPS = OBP + SLG) %>% ungroup()
head(batting)
players <- players %>% separate(debut, "debut_year", sep="-") %>%
select(playerID, birthYear, nameFirst,  nameLast, debut_year)
players
batting <- inner_join(batting, players, by = "playerID") %>%
mutate(year_id = paste(playerID, year, sep="_"))
batting <- inner_join(batting, salaries, by = "year_id")
library(tidyr)
library(ggplot2)
library(dplyr)
library(plotly)
library(scales)
path <- "../Data/baseballdatabank-2019.2/core/"
salaries <- read.csv(paste0(path, "Salaries.csv"))
players <- read.csv(paste0(path, "People.csv"))
batting <- read.csv(paste0(path, "Batting.csv"))
head(players)
salaries <- salaries %>% select(year = yearID, team = teamID, league = lgID, playerID, salary)
avg_salaries_by_league <- salaries %>% group_by(year, league) %>% summarise(avg_salary_league_year = mean(salary)) %>% ungroup()
avg_salaries_by_year <- salaries %>% group_by(year) %>% summarise(avg_salary_league = mean(salary)) %>% ungroup()
ggplot() + geom_line(data = avg_salaries_by_league, aes(x = year, y = avg_salary_league_year, color = league)) +
geom_line(data = avg_salaries_by_year, aes(x = year, y = avg_salary_league, color = "MLB")) + xlab("Year") + ylab("Average_Salary") + ggtitle("Average MLB Salary since 1985") +  scale_y_continuous(labels = comma) + theme_bw()
recent_salaries <- salaries %>% filter(year >= 2012)
recent_salaries %>% ggplot(aes(group = year, x = year, y = salary)) + geom_boxplot() + theme_bw() + scale_y_continuous(labels = comma)
salaries <- salaries %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year_id, salary)
#in case the player had multiple stints
batting <- batting %>% filter(yearID >= 1985, AB > 100) %>% group_by(playerID, year = yearID) %>% summarise( G = sum(G), AB = sum(AB),R = sum(R), H = sum(H), X2B = sum(X2B), X3B = sum(X3B), HR = sum(HR), RBI = sum(RBI), SB = sum(SB), CS = sum(CS), BB = sum(BB), SO = sum(SO), IBB = sum(IBB), HBP = sum(HBP), SH = sum(SH), SF = sum(SF), GIDP = sum(GIDP)) %>% mutate(BA = H/AB, OBP = (H + BB + HBP)/AB + BB + HBP + SF, SLG = (H + X2B + 2*X3B + 3*HR)/AB, OPS = OBP + SLG) %>% ungroup()
head(batting)
players <- players %>% separate(debut, "debut_year", sep="-") %>%
select(playerID, birthYear, nameFirst,  nameLast, debut_year)
batting <- inner_join(batting, players, by = "playerID") %>%
mutate(year_id = paste(playerID, year, sep="_"))
batting <- inner_join(batting, salaries, by = "year_id")
head(batting)
head(batting)
batting %>% ggplot(aes(x = BA)) + geom_boxplot()
batting %>% ggplot(aes(BA)) + geom_boxplot()
boxplot(batting$BA, ylab = "Batting Average")
boxplot(batting$OBP, ylab = "On Base Percentage")
boxplot(batting$SLG, ylab = "Slugging Percentage")
boxplot(batting$BA, ylab = "Batting Average", main = "Batting Average since 1985")
boxplot(batting$BA, ylab = "Batting Average", main = "Batting Average since 1985")
boxplot(batting$OBP, ylab = "On Base Percentage",main = "OBP since 1985")
boxplot(batting$SLG, ylab = "Slugging Percentage", main = "SLG since 1985")
boxplot(batting$OPS, ylab = "OPS", main = "OPS since 1985")
summary(batting$BA)
summary(batting$OBP)
summary(batting$SLG)
summary(batting$OPS)
pitchers <- read.csv(paste0(path, "Pitching.csv"))
batting_no_pitchers <- batting %>% antijoin(, pitchers, by = "playerID")
batting_no_pitchers <- batting %>% anti_join(, pitchers, by = "playerID")
batting_no_pitchers <- anti_join(batting, pitchers, by = "playerID")
batting_no_pitchers
View(batting)
View(batting)
View(batting)
boxplot(batting_no_pitchers$BA, ylab = "Batting Average", main = "Batting Average since 1985")
summary(batting_no_pitchers$BA)
summary(batting_no_pitchers$BA)
summary(batting_no_pitchers$OBP)
summary(batting_no_pitchers$SLG)
summary(batting_no_pitchers$OPS)
boxplot(batting_no_pitchers$OBP, ylab = "On Base Percentage",main = "OBP since 1985")
batting <- read.csv(paste0(path, "Batting.csv"))
#in case the player had multiple stints
batting <- batting %>% filter(yearID >= 1985, AB > 100) %>% group_by(playerID, year = yearID) %>% summarise( G = sum(G), AB = sum(AB),R = sum(R), H = sum(H), X2B = sum(X2B), X3B = sum(X3B), HR = sum(HR), RBI = sum(RBI), SB = sum(SB), CS = sum(CS), BB = sum(BB), SO = sum(SO), IBB = sum(IBB), HBP = sum(HBP), SH = sum(SH), SF = sum(SF), GIDP = sum(GIDP)) %>% mutate(BA = H/AB, OBP = (H + BB + HBP)/(AB + BB + HBP + SF), SLG = (H + X2B + 2*X3B + 3*HR)/AB, OPS = OBP + SLG) %>% ungroup()
batting <- inner_join(batting, players, by = "playerID") %>%
mutate(year_id = paste(playerID, year, sep="_"))
batting <- inner_join(batting, salaries, by = "year_id")
boxplot(batting$OBP, ylab = "On Base Percentage",main = "OBP since 1985")
batting %>% ggplot(aes(x = BA, y = salary), color = year) + geom_point()
batting %>% ggplot(aes(x = BA, y = salary)) + geom_point()
batting <- batting %>% group_by(year) %>% mutate(avg_salary = mean(salary)) %>% ungroup() %>% mutate(zSalary = (salary - avg_salary)/sd(salary))
head(batting)
batting <- batting %>% group_by(year) %>% mutate(avg_salary = mean(salary), sd_salary = sd(salary)) %>% ungroup() %>% mutate(zSalary = (salary - avg_salary)/sd(salary))
head(batting)
tail(batting)
batting_no_pitchers <- anti_join(batting, pitchers, by = "playerID")
batting_no_pitchers %>% ggplot(aes(x = BA, y = Zsalary)) + geom_point()
batting_no_pitchers %>% ggplot(aes(x = BA, y = zSalary)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$BA, use = "pairwise.complete")
batting_no_pitchers %>% ggplot(aes(x = OBP, y = zSalary)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$OBP, use = "pairwise.complete")
batting_no_pitchers %>% ggplot(aes(x = BA, y = zSalary, color = year)) + geom_point()
batting_no_pitchers %>% ggplot(aes(x = OBP, y = zSalary, color = year)) + geom_point()
batting_no_pitchers %>% ggplot(aes(x = SLG, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$SLG, use = "pairwise.complete")
batting_no_pitchers %>% ggplot(aes(x = OPS, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$OPS, use = "pairwise.complete")
cor(batting_no_pitchers$HR, batting_no_pitchers$zSalary, use = "pairwise.complete")
batting <- batting %>% group_by(year) %>% standardize()
batting <- batting %>% group_by(year) %>% scale([,2:22])
batting <- batting %>% group_by(year) %>% scale(_[,2:22])
batting <- batting %>% group_by(year) %>% mutate(avg_SLG = mean(SLG), sd_SLG = sd(SLG)) %>% ungroup() %>% mutate(zSLG = (SLG - avg_SLG)/sd_SLG)
batting
batting_no_pitchers %>% ggplot(aes(x = zSLG, y = zSalary, color = year)) + geom_point()
batting_no_pitchers <- anti_join(batting, pitchers, by = "playerID")
batting_no_pitchers %>% ggplot(aes(x = SLG, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$SLG, use = "pairwise.complete")
batting_no_pitchers %>% ggplot(aes(x = zSLG, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$SLG, use = "pairwise.complete")
batting <- batting %>% select(-zSLG)
batting
batting <- batting %>% select(-c(sd_SLG, avg_SLG))
batting
batting
batting['yearsPlaying'] = batting['year'] - as.numeric(batting['debut_year'])
batting['year']
batting['debut_year']
batting['yearsPlaying'] = batting['year'] - as.numeric(batting['debut_year'])
batting['yearsPlaying'] = batting['year'] - lapply(batting['debut_year'], as.numeric)
batting
batting_no_pitchers <- anti_join(batting, pitchers, by = "playerID")
batting_no_pitchers %>% ggplot(aes(x = yearsPlaying, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$yearsPlaying, use = "pairwise.complete")
batting_no_pitchers %>% ggplot(aes(x = HR, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$HR, use = "pairwise.complete")
batting_no_pitchers %>% ggplot(aes(x = RBI, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$RBI, use = "pairwise.complete")
batting
recent_batting <- batting_no_pitchers %>% filter(year > 2010)
recent_batting %>% ggplot(aes(x = BA, y = zSalary, color = year)) + geom_point()
cor(recent_batting$zSalary, batting_no_pitchers$BA, use = "pairwise.complete")
recent_batting %>% ggplot(aes(x = BA, y = zSalary, color = year)) + geom_point()
cor(recent_batting$zSalary, recent_batting$BA, use = "pairwise.complete")
batting_no_pitchers %>% ggplot(aes(x = BA, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$BA, use = "pairwise.complete")
recent_batting %>% ggplot(aes(x = OPS, y = zSalary, color = year)) + geom_point()
cor(recent_batting$zSalary, recent_batting$OPS, use = "pairwise.complete")
recent_batting %>% ggplot(aes(x = OBP, y = zSalary, color = year)) + geom_point()
cor(recent_batting$zSalary, recent_batting$OBP, use = "pairwise.complete")
recent_batting %>% ggplot(aes(x = SLG, y = zSalary, color = year)) + geom_point()
cor(recent_batting$zSalary, recent_batting$SLG, use = "pairwise.complete")
recent_batting %>% ggplot(aes(x = yearsPlaying, y = zSalary, color = year)) + geom_point()
cor(recent_batting$zSalary, recent_batting$yearsPlaying, use = "pairwise.complete")
batting
fa_recent_batting <- recent_batting %>% filter(yearsPlaying >= 6)
non_fa_recent_batting <- recent_batting %>% filter(yearsPlaying < 6)
boxplot(fa_recent_batting$zSalary, non_fa_recent_batting$zSalary, names = c("Free agents", "Non Free Agents"), ylab = "Normalized Salary for the respective year")
boxplot(fa_recent_batting$zSalary, non_fa_recent_batting$zSalary, names = c("Free agents", "Non Free Agents"), ylab = "Normalized Salary for the respective year", main = "Free agent vs Non Free Agent Salary Comparison")
path <- "../Data/baseballdatabank-2019.2/core/"
salaries <- read.csv(paste0(path, "Salaries.csv"))
players <- read.csv(paste0(path, "People.csv"))
batting <- read.csv(paste0(path, "Batting.csv"))
pitchers <- read.csv(paste0(path, "Pitching.csv"))
head(players)
salaries <- salaries %>% select(year = yearID, team = teamID, league = lgID, playerID, salary)
avg_salaries_by_league <- salaries %>% group_by(year, league) %>% summarise(avg_salary_league_year = mean(salary)) %>% ungroup()
avg_salaries_by_year <- salaries %>% group_by(year) %>% summarise(avg_salary_league = mean(salary)) %>% ungroup()
ggplot() + geom_line(data = avg_salaries_by_league, aes(x = year, y = avg_salary_league_year, color = league)) +
geom_line(data = avg_salaries_by_year, aes(x = year, y = avg_salary_league, color = "MLB")) + xlab("Year") + ylab("Average_Salary") + ggtitle("Average MLB Salary since 1985") +  scale_y_continuous(labels = comma) + theme_bw()
recent_salaries <- salaries %>% filter(year >= 2012)
recent_salaries %>% ggplot(aes(group = year, x = year, y = salary)) + geom_boxplot() + theme_bw() + scale_y_continuous(labels = comma)
salaries <- salaries %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year_id, salary)
#in case the player had multiple stints
batting <- batting %>% filter(yearID >= 1985, AB > 100) %>% group_by(playerID, year = yearID) %>% summarise( G = sum(G), AB = sum(AB),R = sum(R), H = sum(H), X2B = sum(X2B), X3B = sum(X3B), HR = sum(HR), RBI = sum(RBI), SB = sum(SB), CS = sum(CS), BB = sum(BB), SO = sum(SO), IBB = sum(IBB), HBP = sum(HBP), SH = sum(SH), SF = sum(SF), GIDP = sum(GIDP)) %>% mutate(BA = H/AB, OBP = (H + BB + HBP)/(AB + BB + HBP + SF), SLG = (H + X2B + 2*X3B + 3*HR)/AB, OPS = OBP + SLG, TA = (BB + HBP + SB + SLG*AB - CS)/(AB - H + CS + GIDP), GPA = (1.8 * OBP + SLG)/4) %>% ungroup()
head(batting)
players <- players %>% separate(debut, "debut_year", sep="-") %>%
select(playerID, birthYear, nameFirst,  nameLast, debut_year)
batting <- inner_join(batting, players, by = "playerID") %>%
mutate(year_id = paste(playerID, year, sep="_"))
batting <- inner_join(batting, salaries, by = "year_id") %>% mutate(yearsPlaying = year - as.numeric(debut_year))
head(batting)
batting <- batting %>% group_by(year) %>% mutate(avg_salary = mean(salary), sd_salary = sd(salary)) %>% ungroup() %>% mutate(zSalary = (salary - avg_salary)/sd(salary))
tail(batting)
batting_no_pitchers <- anti_join(batting, pitchers, by = "playerID")
boxplot(batting_no_pitchers$TA, ylab = "TA", main = "TA since 1985")
batting_no_pitchers %>% ggplot(aes(x = TA, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$TA, use = "pairwise.complete")
batting_no_pitchers %>% ggplot(aes(x = GPA, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$GPA, use = "pairwise.complete")
batting_no_pitchers %>% ggplot(aes(x = TA, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$TA, use = "pairwise.complete")
recent_batting %>% ggplot(aes(x = TA, y = zSalary, color = year)) + geom_point()
recent_batting <- batting_no_pitchers %>% filter(year > 2010)
recent_batting %>% ggplot(aes(x = TA, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$TA, use = "pairwise.complete")
recent_batting %>% ggplot(aes(x = TA, y = zSalary, color = year)) + geom_point()
cor(recent_batting$zSalary, recent_batting$TA, use = "pairwise.complete")
recent_batting %>% ggplot(aes(x = GPA, y = zSalary, color = year)) + geom_point()
cor(recent_batting$zSalary, recent_batting$GPA, use = "pairwise.complete")
boxplot(fa_recent_batting$zSalary, non_fa_recent_batting$zSalary, names = c("Free agents", "Non Free Agents"), ylab = "Normalized Salary for the respective year", main = "Free agent vs Non Free Agent Salary Comparison")
recent_batting %>% ggplot(aes(x = AB, y = zSalary, color = year)) + geom_point()
cor(recent_batting$zSalary, recent_batting$AB, use = "pairwise.complete")
summary(fa_recent_batting$zSalary)
summary(non_fa_recent_batting$zSalary)
boxplot(fa_recent_batting$zSalary, non_fa_recent_batting$zSalary, names = c("Free agents", "Non Free Agents"), ylab = "Normalized Salary for the respective year", main = "Free agent vs Non Free Agent Salary Comparison")
#calculate upper bound for outliers
non_fa_salary_UB = quantile(non_fa_recent_batting$salary, .75) + 1.5* IQR(non_fa_recent_batting$salary)
non_fa_salary_UB
#calculate upper bound for outliers
non_fa_salary_UB = quantile(non_fa_recent_batting$zSalary, .75) + 1.5* IQR(non_fa_recent_batting$zSalary)
#calculate upper bound for outliers
non_fa_salary_UB = quantile(non_fa_recent_batting$zSalary, .75) + 1.5* IQR(non_fa_recent_batting$zSalary)
non_fa_salary_UB
non_fa_salary_outliers <- non_fa_recent_batting %>% filter(zSalary >= non_fa_salary_UB)
non_fa_salary_outliers
#calculate upper bound for outliers
non_fa_salary_UB = quantile(non_fa_recent_batting$zSalary, .75) + 1.5* IQR(non_fa_recent_batting$zSalary)
#Get the outliers
non_fa_salary_outliers <- non_fa_recent_batting %>% filter(zSalary >= non_fa_salary_UB)
non_fa_salary_normal <- non_fa_recent_batting %>% filter(zSalary < non_fa_salary_UB)
boxplot(non_fa_salary_outliers$HR, non_fa_salary_normal$HR, names = ("Outliers", "Non Outliers"), ylab = "Home Runs")
boxplot(non_fa_salary_outliers$HR, non_fa_salary_normal$HR, names = c("Outliers", "Non Outliers"), ylab = "Home Runs")
boxplot(non_fa_salary_outliers$HR, non_fa_salary_normal$HR, names = c("Outliers", "Non Outliers"), ylab = "Home Runs", main = "Homeruns for the outliers and non outliers in the non-free agent group")
boxplot(non_fa_salary_outliers$BA, non_fa_salary_normal$BA, names = c("Outliers", "Non Outliers"), ylab = "Batting Average", main = "Batting Average for the outliers and non outliers in the non-free agent group")
head(batting)
boxplot(non_fa_salary_outliers$G, non_fa_salary_normal$G, names = c("Outliers", "Non Outliers"), ylab = "Games", main = "Games for the outliers and non outliers in the non-free agent group")
boxplot(non_fa_salary_outliers$RBI, non_fa_salary_normal$RBI, names = c("Outliers", "Non Outliers"), ylab = "RBIs", main = "RBIs for the outliers and non outliers in the non-free agent group")
boxplot(non_fa_salary_outliers$OBP, non_fa_salary_normal$OBP, names = c("Outliers", "Non Outliers"), ylab = "OBP", main = "OBP for the outliers and non outliers in the non-free agent group")
boxplot(non_fa_salary_outliers$SLG, non_fa_salary_normal$SLG, names = c("Outliers", "Non Outliers"), ylab = "SLG", main = "SLG for the outliers and non outliers in the non-free agent group")
boxplot(non_fa_salary_outliers$OPS, non_fa_salary_normal$OPS, names = c("Outliers", "Non Outliers"), ylab = "OPS", main = "OPS for the outliers and non outliers in the non-free agent group")
boxplot(non_fa_salary_outliers$TA, non_fa_salary_normal$TA, names = c("Outliers", "Non Outliers"), ylab = "TA", main = "TA for the outliers and non outliers in the non-free agent group")
boxplot(non_fa_salary_outliers$TA, non_fa_salary_normal$TA, names = c("Outliers", "Non Outliers"), ylab = "TA", main = "TA for the outliers and non outliers in the non-free agent group")
non_fa_salary_outliers$TA
non_fa_salary_outliers
boxplot(non_fa_salary_outliers$HR, non_fa_salary_normal$HR, names = c("Outliers", "Non Outliers"), ylab = "Home Runs", main = "Home runs for the outliers and non outliers in the non-free agent group")
non_fa_salary_normal %>% ggplot(aes(x = HR)) + geom_density() + theme_bw()
non_fa_salary_outliers %>% ggplot(aes(x = HR)) + geom_density() + theme_bw()
non_fa_salary_normal %>% ggplot(aes(x = HR)) + geom_density() + theme_bw()
non_fa_salary_outliers %>% ggplot(aes(x = HR)) + geom_density() + theme_bw()
boxplot(non_fa_salary_outliers$BA, non_fa_salary_normal$BA, names = c("Outliers", "Non Outliers"), ylab = "Batting Average", main = "Batting Average for the outliers and non outliers in the non-free agent group")
boxplot(non_fa_salary_outliers$BA, non_fa_salary_normal$BA, names = c("Outliers", "Non Outliers"), ylab = "Batting Average", main = "Batting Average for the outliers and non outliers in the non-free agent group")
boxplot(non_fa_salary_outliers$RBI, non_fa_salary_normal$RBI, names = c("Outliers", "Non Outliers"), ylab = "RBIs", main = "RBIs for the outliers and non outliers in the non-free agent group")
fa_salary_UB = quantile(fa_recent_batting$zSalary, .75) + 1.5* IQR(fa_recent_batting$zSalary)
fa_salary_outliers <- fa_recent_batting %>% filter(zSalary >= fa_salary_UB)
fa_salary_normal <- fa_recent_batting %>% filter(zSalary < fa_salary_UB)
boxplot(fa_salary_outliers$HR, fa_salary_normal$HR, names = c("Outliers", "Non Outliers"), ylab = "Home Runs", main = "Home runs for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$BA, fa_salary_normal$BA, names = c("Outliers", "Non Outliers"), ylab = "Batting Average", main = "Batting Average for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$G, fa_salary_normal$G, names = c("Outliers", "Non Outliers"), ylab = "Games", main = "Games for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$RBI, fa_salary_normal$RBI, nmes = c("Outliers", "Non Outliers"), ylab = "RBIs", main = "RBIs for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$BA, fa_salary_normal$BA, names = c("Outliers", "Non Outliers"), ylab = "Batting Average", main = "Batting Average for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$G, fa_salary_normal$G, names = c("Outliers", "Non Outliers"), ylab = "Games", main = "Games for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$RBI, fa_salary_normal$RBI, nmes = c("Outliers", "Non Outliers"), ylab = "RBIs", main = "RBIs for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$RBI, fa_salary_normal$RBI, nmes = c("Outliers", "Non Outliers"), ylab = "RBIs", main = "RBIs for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$RBI, fa_salary_normal$RBI, names = c("Outliers", "Non Outliers"), ylab = "RBIs", main = "RBIs for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$OBP, fa_salary_normal$OBP, names = c("Outliers", "Non Outliers"), ylab = "OBP", main = "OBP for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$SLG, fa_salary_normal$SLG, names = c("Outliers", "Non Outliers"), ylab = "SLG", main = "SLG for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$OPS, fa_salary_normal$OPS, names = c("Outliers", "Non Outliers"), ylab = "OPS", main = "OPS for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$HR, fa_salary_normal$HR, names = c("Outliers", "Non Outliers"), ylab = "Home Runs", main = "Home runs for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$BA, fa_salary_normal$BA, names = c("Outliers", "Non Outliers"), ylab = "Batting Average", main = "Batting Average for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$HR, fa_salary_normal$HR, names = c("Outliers", "Non Outliers"), ylab = "Home Runs", main = "Home runs for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$BA, fa_salary_normal$BA, names = c("Outliers", "Non Outliers"), ylab = "Batting Average", main = "Batting Average for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$G, fa_salary_normal$G, names = c("Outliers", "Non Outliers"), ylab = "Games", main = "Games for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$RBI, fa_salary_normal$RBI, names = c("Outliers", "Non Outliers"), ylab = "RBIs", main = "RBIs for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$OBP, fa_salary_normal$OBP, names = c("Outliers", "Non Outliers"), ylab = "OBP", main = "OBP for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$SLG, fa_salary_normal$SLG, names = c("Outliers", "Non Outliers"), ylab = "SLG", main = "SLG for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$HR, fa_salary_normal$HR, names = c("Outliers", "Non Outliers"), ylab = "Home Runs", main = "Home runs for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$BA, fa_salary_normal$BA, names = c("Outliers", "Non Outliers"), ylab = "Batting Average", main = "Batting Average for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$G, fa_salary_normal$G, names = c("Outliers", "Non Outliers"), ylab = "Games", main = "Games for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$RBI, fa_salary_normal$RBI, names = c("Outliers", "Non Outliers"), ylab = "RBIs", main = "RBIs for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$OBP, fa_salary_normal$OBP, names = c("Outliers", "Non Outliers"), ylab = "OBP", main = "OBP for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$SLG, fa_salary_normal$SLG, names = c("Outliers", "Non Outliers"), ylab = "SLG", main = "SLG for the outliers and non outliers in the free agent group")
boxplot(fa_salary_outliers$OPS, fa_salary_normal$OPS, names = c("Outliers", "Non Outliers"), ylab = "OPS", main = "OPS for the outliers and non outliers in the free agent group")
cor(fa_salary_normal$HR, fa_salary_normal$HR)
cor(fa_salary_normal$zSalary, fa_salary_normal$HR)
cor(fa_salary_outliers$zSalary, fa_salary_outliers$HR)
cor(fa_recent_batting$zSalary, fa_recent_batting$HR)
cor(non_fa_recent_batting$zSalary, non_fa_recent$HR)
cor(non_fa_recent_batting$zSalary, non_fa_recent+batting$HR)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$HR)
cor(fa_recent_batting$zSalary, fa_recent_batting$HR)
fa_recent_batting %>% ggplot(aes(x = HR, y = zSalary)) + geom_point() + theme_bw()
non_fa_recent_batting %>% ggplot(aes(x = HR, y = zSalary)) + geom_point() + theme_bw()
fa_recent_batting %>% ggplot(aes(x = HR, y = zSalary)) + geom_point() + theme_bw()
cor(fa_recent_batting$zSalary, fa_recent_batting$RBI)
cor(fa_recent_batting$zSalary, fa_recent_batting$OBP)
cor(fa_recent_batting$zSalary, fa_recent_batting$OPS)
cor(fa_recent_batting$zSalary, fa_recent_batting$H)
head(fa_recent_batting)
cor(fa_recent_batting$zSalary, fa_recent_batting$SLG)
non_cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$RBI)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$RBI)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$OBP)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$H)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$SLG)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$OPS)
path <- "../Data/baseballdatabank-2019.2/core/"
salaries <- read.csv(paste0(path, "Salaries.csv"))
players <- read.csv(paste0(path, "People.csv"))
batting <- read.csv(paste0(path, "Batting.csv"))
pitchers <- read.csv(paste0(path, "Pitching.csv"))
head(players)
salaries <- salaries %>% select(year = yearID, team = teamID, league = lgID, playerID, salary)
avg_salaries_by_league <- salaries %>% group_by(year, league) %>% summarise(avg_salary_league_year = mean(salary)) %>% ungroup()
avg_salaries_by_year <- salaries %>% group_by(year) %>% summarise(avg_salary_league = mean(salary)) %>% ungroup()
ggplot() + geom_line(data = avg_salaries_by_league, aes(x = year, y = avg_salary_league_year, color = league)) +
geom_line(data = avg_salaries_by_year, aes(x = year, y = avg_salary_league, color = "MLB")) + xlab("Year") + ylab("Average_Salary") + ggtitle("Average MLB Salary since 1985") +  scale_y_continuous(labels = comma) + theme_bw()
recent_salaries <- salaries %>% filter(year >= 2012)
recent_salaries %>% ggplot(aes(group = year, x = year, y = salary)) + geom_boxplot() + theme_bw() + scale_y_continuous(labels = comma)
salaries <- salaries %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year_id, salary)
#in case the player had multiple stints
batting <- batting %>% filter(yearID >= 1985, AB > 100) %>% group_by(playerID, year = yearID) %>% summarise( G = sum(G), AB = sum(AB),R = sum(R), H = sum(H), X2B = sum(X2B), X3B = sum(X3B), HR = sum(HR), RBI = sum(RBI), SB = sum(SB), CS = sum(CS), BB = sum(BB), SO = sum(SO), IBB = sum(IBB), HBP = sum(HBP), SH = sum(SH), SF = sum(SF), GIDP = sum(GIDP)) %>% mutate(BA = H/AB, OBP = (H + BB + HBP)/(AB + BB + HBP + SF), SLG = (H + X2B + 2*X3B + 3*HR)/AB, OPS = OBP + SLG, TA = (BB + HBP + SB + SLG*AB - CS)/(AB - H + CS + GIDP), GPA = (1.8 * OBP + SLG)/4) %>% ungroup()
head(batting)
players <- players %>% separate(debut, "debut_year", sep="-") %>%
select(playerID, birthYear, nameFirst,  nameLast, debut_year)
batting <- inner_join(batting, players, by = "playerID") %>%
mutate(year_id = paste(playerID, year, sep="_"))
batting <- inner_join(batting, salaries, by = "year_id") %>% mutate(yearsPlaying = year - as.numeric(debut_year))
head(batting)
batting <- batting %>% group_by(year) %>% mutate(avg_salary = mean(salary), sd_salary = sd(salary)) %>% ungroup() %>% mutate(zSalary = (salary - avg_salary)/sd(salary))
tail(batting)
batting_no_pitchers <- anti_join(batting, pitchers, by = "playerID")
batting_no_pitchers %>% ggplot(aes(x = BA, y = zSalary, color = year)) + geom_point()
cor(batting_no_pitchers$zSalary, batting_no_pitchers$BA, use = "pairwise.complete")
recent_batting <- batting_no_pitchers %>% filter(year > 2010)
fa_recent_batting <- recent_batting %>% filter(yearsPlaying >= 6)
non_fa_recent_batting <- recent_batting %>% filter(yearsPlaying < 6)
#calculate upper bound for outliers
non_fa_salary_UB = quantile(non_fa_recent_batting$zSalary, .75) + 1.5* IQR(non_fa_recent_batting$zSalary)
fa_salary_UB = quantile(fa_recent_batting$zSalary, .75) + 1.5* IQR(fa_recent_batting$zSalary)
#Get the outliers and normal
non_fa_salary_outliers <- non_fa_recent_batting %>% filter(zSalary >= non_fa_salary_UB)
non_fa_salary_normal <- non_fa_recent_batting %>% filter(zSalary < non_fa_salary_UB)
fa_salary_outliers <- fa_recent_batting %>% filter(zSalary >= fa_salary_UB)
fa_salary_normal <- fa_recent_batting %>% filter(zSalary < fa_salary_UB)
boxplot(non_fa_salary_outliers$GPA, non_fa_salary_normal$GPA, names = c("Outliers", "Non Outliers"), ylab = "GPA", main = "GPA for the outliers and non outliers in the non-free agent group")
boxplot(fa_salary_outliers$GPA, fa_salary_normal$GPA, names = c("Outliers", "Non Outliers"), ylab = "GPA", main = "GPA for the outliers and non outliers in the free agent group")
cor(fa_recent_batting$zSalary, fa_recent_batting$TA)
#FREE AGENTS
head(fa_recent_batting)
cor(fa_recent_batting$zSalary, fa_recent_batting$HR)
cor(fa_recent_batting$zSalary, fa_recent_batting$RBI)
cor(fa_recent_batting$zSalary, fa_recent_batting$OBP)
cor(fa_recent_batting$zSalary, fa_recent_batting$H)
cor(fa_recent_batting$zSalary, fa_recent_batting$SLG)
cor(fa_recent_batting$zSalary, fa_recent_batting$OPS)
cor(fa_recent_batting$zSalary, fa_recent_batting$TA)
cor(fa_recent_batting$zSalary, fa_recent_batting$GPA)
#NON FREE AGENTS
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$HR)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$RBI)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$OBP)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$H)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$SLG)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$OPS)
cor(fa_recent_batting$zSalary, fa_recent_batting$GPA)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$TA)
cor(non_fa_recent_batting$zSalary, non_fa_recent_batting$GPA)
non_fa_recent_batting %>%ggplot(aes(x = RBI, y = zSalary, colo = yearsPlaying)) + geom_point()
non_fa_recent_batting %>%ggplot(aes(x = RBI, y = zSalary, color = yearsPlaying)) + geom_point()
nonRookies <- non_fa_recent_batting %>% filter(yearsPlaying > 1)
nonRoolies %>%ggplot(aes(x = RBI, y = zSalary, color = yearsPlaying)) + geom_point()
nonRookies %>%ggplot(aes(x = RBI, y = zSalary, color = yearsPlaying)) + geom_point()
nonRookies <- non_fa_recent_batting %>% filter(yearsPlaying > 2)
nonRookies %>%ggplot(aes(x = RBI, y = zSalary, color = yearsPlaying)) + geom_point()
cor(nonRookies$zSalary, nonRookies$RBI)
cor(nonRookies$zSalary, nonRookies$HR)
nonRookies %>%ggplot(aes(x = HR, y = zSalary, color = yearsPlaying)) + geom_point()
nonRookies %>%ggplot(aes(x = OPS, y = zSalary, color = yearsPlaying)) + geom_point()
cor(nonRookies$zSalary, nonRookies,OPS)
cor(nonRookies$zSalary, nonRookies$OPS)
fielding <- read.csv(paste0(path, "Fielding.csv"))
fielding <- fielding %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year_id, POS)
fielding <- fielding %>% mutate(year_id = paste(playerID, yearID, sep="_")) %>% select(year_id, POS)
fielding <- inner_join(fielding, salaries, by = "year_id")
fielding
fielding <- read.csv(paste0(path, "Fielding.csv"))
fielding <- inner_join(fielding, salaries, by = "playerID")
salaries <- read.csv(paste0(path, "Salaries.csv"))
salaries <- salaries %>% select(year = yearID, team = teamID, league = lgID, playerID, salary)
salaries <- salaries %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year_id, salary)
fielding <- fielding %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year_id, salary)
fielding <- fielding %>% mutate(year_id = paste(playerID, yearID, sep="_")) %>% select(year_id, salary)
salaries <- salaries %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year_id, salary, year = yearID)
salaries <- read.csv(paste0(path, "Salaries.csv"))
fielding <- read.csv(paste0(path, "Fielding.csv"))
salaries <- salaries %>% select(year = yearID, team = teamID, league = lgID, playerID, salary)
salaries <- salaries %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year_id, salary, year = yearID)
salaries
salaries <- salaries %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year_id, salary, year)
fielding
fielding <- fielding %>% mutate(year_id = paste(playerID, yearID, sep="_")) %>% select(year = yearID, year_id, salary)
fielding <- fielding %>% mutate(year_id = paste(playerID, yearID, sep="_")) %>% select(year = yearID, year_id, POS)
fielding
salaries
fielding <- inner_join(fielding, salaries, by = "year_id")
fielding
salaries
salaries <- read.csv(paste0(path, "Salaries.csv"))
fielding <- read.csv(paste0(path, "Fielding.csv"))
salaries <- salaries %>% select(year = yearID, team = teamID, league = lgID, playerID, salary)
salaries <- salaries %>% mutate(year_id = paste(playerID, year, sep="_")) %>% select(year_id, salary, year)
fielding <- inner_join(fielding, salaries, by = "year_id")
fielding <- fielding %>% mutate(year_id = paste(playerID, yearID, sep="_")) %>% select(year_id, POS)
fielding <- inner_join(fielding, salaries, by = "year_id")
fielding
fielding
fielding
fielding <- read.csv(paste0(path, "Fielding.csv"))
fielding <- fielding %>% mutate(year_id = paste(playerID, yearID, sep="_"))
fielding <- inner_join(fielding, salaries, by = "year_id")
fielding
fielding = fielding %>% select(-yearID)
fielding
fielding_sal_over_time <- fielding %>% group_by(year, position) %>% summarise(salary = sum(salary)) %>% ungroup()
fielding_sal_over_time <- fielding %>% group_by(year, POS) %>% summarise(salary = sum(salary)) %>% ungroup()
fielding_sal_over_time
fielding_sal_over_time <- fielding %>% group_by(year, POS) %>% summarise(avg_salary = mean(salary)) %>% ungroup()
fielding_sal_over_time
fielding_sal_over_time %>% ggplot(aes(x = year, y = avg_salary, POS)) + geom_line() + theme_bw() + ggtitle("Average Salary Over Time for Baseball Positions") + xlab("year") + ylab("Salary")
fielding_sal_over_time %>% ggplot(aes(x = year, y = avg_salary, color = POS)) + geom_line() + theme_bw() + ggtitle("Average Salary Over Time for Baseball Positions") + xlab("year") + ylab("Salary")
fielding_sal_over_time %>% ggplot(aes(x = year, y = avg_salary, color = POS)) + geom_line() + theme_bw() + ggtitle("Average Salary Over Time for Baseball Positions") + xlab("year") + ylab("Salary") + scale_y_continuous(name = comma)
fielding_sal_over_time %>% ggplot(aes(x = year, y = avg_salary, color = POS)) + geom_line() + theme_bw() + ggtitle("Average Salary Over Time for Baseball Positions") + xlab("year") + ylab("Salary") + scale_y_continuous(labels = comma)
fielding
fielding <- inner_join(fielding, players, by = "playerID")
fielding
fielding_recent <- fielding %>% filter(year >= 2010)
fielding_recent %>% ggplot(aes(group = POS, x = POS, y = Salary)) + geom_boxplot()
fielding_recent %>% ggplot(aes(group = POS, x = POS, y = salary)) + geom_boxplot()
fielding
ggplot() + geom_line(data = avg_salaries_by_league, aes(x = year, y = avg_salary_league_year, color = league)) +
geom_line(data = avg_salaries_by_year, aes(x = year, y = avg_salary_league, color = "MLB")) + xlab("Year") + ylab("Average_Salary") + ggtitle("Average MLB Salary since 1985") +  scale_y_continuous(labels = comma) + theme_bw()
setwd("~/Sports Analytics/MLB/Tutorial_1")
path <- "Data/baseballdatabank-2019.2/core/"
salaries <- read.csv(paste0(path, "Salaries.csv"))
paste0(path, "Salaries.csv")
getwd()
path <- "../Data/baseballdatabank-2019.2/core/"
salaries <- read.csv(paste0(path, "Salaries.csv"))
